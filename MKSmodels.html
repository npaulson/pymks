
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>MKS Models &mdash; PyMKS</title>
    
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.3.6/cosmo/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pymks.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/pymks_logo.ico"/>
    <link rel="top" title="PyMKS" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body role="document">


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><img src="_static/pymks_logo.png">
          PyMKS</a>
        <span class="navbar-text navbar-version pull-left"><b>0.3.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="rst/INSTALLATION.html">Installation</a></li>
                <li><a href="EXAMPLES.html">Examples</a></li>
                <li><a href="API.html">API</a></li>
                <li><a href="https://github.com/materialsinnovation/pymks/">Github</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">More <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="THEORY.html">Theory</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rst/derivation.html">Derivation of MKS Localization Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rst/tech_overview.html">Technical Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rst/CREDITS.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/LICENSE.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/CITATION.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="rst/REQUIREMENTS.html">Requirements</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          

        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="mks-models">
<h1>MKS Models<a class="headerlink" href="#mks-models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="mksstructureanalysis">
<h2>MKSStructureAnalysis<a class="headerlink" href="#mksstructureanalysis" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pymks.mks_structure_analysis.MKSStructureAnalysis">
<em class="property">class </em><code class="descclassname">pymks.mks_structure_analysis.</code><code class="descname">MKSStructureAnalysis</code><span class="sig-paren">(</span><em>basis</em>, <em>correlations=None</em>, <em>dimension_reducer=None</em>, <em>n_components=None</em>, <em>periodic_axes=None</em>, <em>store_correlations=False</em>, <em>n_jobs=1</em>, <em>mean_center=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_structure_analysis.MKSStructureAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>MKSStructureAnalysis</cite> computes the 2-point statistics for a set of
microstructures and does dimensionality reduction. It can be used to
evaluate the selection of spatial correlations and look at clustering of
2-point statistics.</p>
<dl class="attribute">
<dt id="MKSStructureAnalysis.n_components">
<code class="descname">n_components</code><a class="headerlink" href="#MKSStructureAnalysis.n_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of components used by <cite>dimension_reducer</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSStructureAnalysis.dimension_reducer">
<code class="descname">dimension_reducer</code><a class="headerlink" href="#MKSStructureAnalysis.dimension_reducer" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of a dimensionality reduction class.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSStructureAnalysis.correlations">
<code class="descname">correlations</code><a class="headerlink" href="#MKSStructureAnalysis.correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>spatial correlations to be computed</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSStructureAnalysis.basis">
<code class="descname">basis</code><a class="headerlink" href="#MKSStructureAnalysis.basis" title="Permalink to this definition">¶</a></dt>
<dd><p>instance of a basis class</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSStructureAnalysis.reduced_fit_data">
<code class="descname">reduced_fit_data</code><a class="headerlink" href="#MKSStructureAnalysis.reduced_fit_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Low dimensionality representation of spatial
correlations used to fit the components.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSStructureAnalysis.reduced_transformed_data">
<code class="descname">reduced_transformed_data</code><a class="headerlink" href="#MKSStructureAnalysis.reduced_transformed_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduced of spatial correlations.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSStructureAnalysis.periodic_axes">
<code class="descname">periodic_axes</code><a class="headerlink" href="#MKSStructureAnalysis.periodic_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>axes that are periodic. (0, 2) would indicate that
axes x and z are periodic in a 3D microstrucure.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSStructureAnalysis.transformed_correlations">
<code class="descname">transformed_correlations</code><a class="headerlink" href="#MKSStructureAnalysis.transformed_correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>spatial correlations transform into the Low
dimensional space.</p>
</dd></dl>

<p>Below is an example of using MKSStructureAnalysis using FastICA.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_microstructure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">FastICA</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">leg_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reducer</span> <span class="o">=</span> <span class="n">FastICA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">MKSStructureAnalysis</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">leg_basis</span><span class="p">,</span> <span class="n">mean_center</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">dimension_reducer</span><span class="o">=</span><span class="n">reducer</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">make_microstructure</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="n">grain_size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> 
<span class="go">[[ 0.5 -0.5 -0.5]</span>
<span class="go"> [ 0.5  0.5  0.5]</span>
<span class="go"> [-0.5 -0.5  0.5]</span>
<span class="go"> [-0.5  0.5 -0.5]]</span>
</pre></div>
</div>
<p>Create an instance of a <cite>MKSStructureAnalysis</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>basis</strong> &#8211; an instance of a bases class.</li>
<li><strong>dimension_reducer</strong> (<em>class, optional</em>) &#8211; an instance of a
dimensionality reduction class with a fit_transform method. The
default class is RandomizedPCA.</li>
<li><strong>n_components</strong> (<em>int, optional</em>) &#8211; number of components kept by the
dimension_reducer</li>
<li><strong>correlations</strong> (<em>list, optional</em>) &#8211; list of spatial correlations to
compute, default is the autocorrelation with the first local
state and all of its cross correlations. For example if basis
has basis.n_states=3, correlation would be [(0, 0), (0, 1),
(0, 2)]. If n_states=[0, 2, 4], the default correlations are
[(0, 0), (0, 2), (0, 4)] corresponding to the autocorrelations
for the 0th local state, and the cross correlations with the 0
and 2 as well as 0 and 4.</li>
<li><strong>periodic_axes</strong> (<em>list, optional</em>) &#8211; axes that are periodic. (0, 2)
would indicate that axes x and z are periodic in a 3D
microstrucure.</li>
<li><strong>store_correlations</strong> (<em>boolean, optional</em>) &#8211; If true the computed
2-point statistics will be saved as an attributes
fit_correlations and transform_correlations.</li>
<li><strong>n_jobs</strong> (<em>int, optional</em>) &#8211; number of parallel jobs to run. only used
if pyfftw is install.</li>
<li><strong>mean_center</strong> (<em>boolean, optional</em>) &#8211; If true the data will be mean
centered before dimensionality reduction is computed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pymks.mks_structure_analysis.MKSStructureAnalysis.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>reducer_labels=None</em>, <em>confidence_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_structure_analysis.MKSStructureAnalysis.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits data by using the 2-point statistics for X to fits the
components used in dimensionality reduction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>ND array</em>) &#8211; The microstructures or spatial correlations, a
<cite>(n_samples, n_x, ...)</cite> shaped array where <cite>n_samples</cite> is the
number of samples and <cite>n_x</cite> is the spatial discretization.</li>
<li><strong>reducer_labels</strong> (<em>1D array, optional</em>) &#8211; label for X used during the
fit_transform method for the <cite>dimension_reducer</cite>.</li>
<li><strong>confidence_index</strong> (<em>ND array, optional</em>) &#8211; array with same shape as X
used to assign a confidence value for each data point.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_delta_microstructures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_states</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">MKSStructureAnalysis</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">dimension_reducer</span><span class="o">.</span><span class="n">components_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">size</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">... </span>
<span class="go">[[ 0.02886463  0.02886463  0.02886463]</span>
<span class="go"> [ 0.02886463 -0.43874233  0.49647159]</span>
<span class="go"> [ 0.02886463  0.02886463 -0.17896069]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymks.mks_structure_analysis.MKSStructureAnalysis.fit_transform">
<code class="descname">fit_transform</code><span class="sig-paren">(</span><em>X</em>, <em>confidence_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_structure_analysis.MKSStructureAnalysis.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits data by using the 2-point statistics for X to fits the
components used in dimensionality reduction and returns the reduction
of the 2-point statistics for X.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>ND array</em>) &#8211; The microstructures or spatial correlations, a
<cite>(n_samples, n_x, ...)</cite> shaped array where <cite>n_samples</cite> is the
number of samples and <cite>n_x</cite> is the spatial discretization.</li>
<li><strong>reducer_labels</strong> (<em>1D array, optional</em>) &#8211; label for X used during the
fit_transform method for the <cite>dimension_reducer</cite>..</li>
<li><strong>confidence_index</strong> (<em>ND array, optional</em>) &#8211; array with same shape as X
used to assign a confidence value for each data point.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Reduction of the 2-point statistics of X used to fit the components.</p>
</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_delta_microstructures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_states</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">MKSStructureAnalysis</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> 
<span class="go">[[ 0.26731852]</span>
<span class="go"> [-0.26731852]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymks.mks_structure_analysis.MKSStructureAnalysis.transform">
<code class="descname">transform</code><span class="sig-paren">(</span><em>X</em>, <em>confidence_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_structure_analysis.MKSStructureAnalysis.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the 2-point statistics for X and applies dimensionality
reduction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>ND array</em>) &#8211; The microstructures or spatial correlations, a
<cite>(n_samples, n_x, ...)</cite> shaped array where <cite>n_samples</cite> is the
number of samples and <cite>n_x</cite> is the spatial discretization.</li>
<li><strong>confidence_index</strong> (<em>ND array, optional</em>) &#8211; array with same shape as X
used to assign a confidence value for each data point.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Reduction of the 2-point statistics of X.</p>
</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_delta_microstructures</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_states</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">MKSStructureAnalysis</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> 
<span class="go">[[ 0.26731852]</span>
<span class="go"> [-0.26731852]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">))</span> 
<span class="go">[[ 0.26731852]</span>
<span class="go"> [-0.26731852]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mkshomogenizationmodel">
<h2>MKSHomogenizationModel<a class="headerlink" href="#mkshomogenizationmodel" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pymks.mks_homogenization_model.MKSHomogenizationModel">
<em class="property">class </em><code class="descclassname">pymks.mks_homogenization_model.</code><code class="descname">MKSHomogenizationModel</code><span class="sig-paren">(</span><em>basis=None</em>, <em>dimension_reducer=None</em>, <em>n_components=None</em>, <em>property_linker=None</em>, <em>degree=1</em>, <em>periodic_axes=None</em>, <em>correlations=None</em>, <em>compute_correlations=True</em>, <em>n_jobs=1</em>, <em>store_correlations=False</em>, <em>mean_center=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_homogenization_model.MKSHomogenizationModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>MKSHomogenizationModel</cite> takes in microstructures and a their
associated macroscopic property, and created a low dimensional structure
property linkage. The <cite>MKSHomogenizationModel</cite> model is designed to
integrate with dimensionality reduction techniques and predictive models.</p>
<dl class="attribute">
<dt id="MKSHomogenizationModel.degree">
<code class="descname">degree</code><a class="headerlink" href="#MKSHomogenizationModel.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree of the polynomial used by
<cite>property_linker</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.n_components">
<code class="descname">n_components</code><a class="headerlink" href="#MKSHomogenizationModel.n_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of components used by <cite>dimension_reducer</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.dimension_reducer">
<code class="descname">dimension_reducer</code><a class="headerlink" href="#MKSHomogenizationModel.dimension_reducer" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of a dimensionality reduction class.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.property_linker">
<code class="descname">property_linker</code><a class="headerlink" href="#MKSHomogenizationModel.property_linker" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance of class that maps materials property to the
microstuctures.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.correlations">
<code class="descname">correlations</code><a class="headerlink" href="#MKSHomogenizationModel.correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>spatial correlations to be computed</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.basis">
<code class="descname">basis</code><a class="headerlink" href="#MKSHomogenizationModel.basis" title="Permalink to this definition">¶</a></dt>
<dd><p>instance of a basis class</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.reduced_fit_data">
<code class="descname">reduced_fit_data</code><a class="headerlink" href="#MKSHomogenizationModel.reduced_fit_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Low dimensionality representation of spatial
correlations used to fit the model.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.reduced_predict_data">
<code class="descname">reduced_predict_data</code><a class="headerlink" href="#MKSHomogenizationModel.reduced_predict_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Low dimensionality representation of spatial
correlations predicted by the model.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.periodic_axes">
<code class="descname">periodic_axes</code><a class="headerlink" href="#MKSHomogenizationModel.periodic_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>axes that are periodic. (0, 2) would indicate that
axes x and z are periodic in a 3D microstrucure.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.coef_">
<code class="descname">coef_</code><a class="headerlink" href="#MKSHomogenizationModel.coef_" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of values that are the coefficients.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSHomogenizationModel.intercept_">
<code class="descname">intercept_</code><a class="headerlink" href="#MKSHomogenizationModel.intercept_" title="Permalink to this definition">¶</a></dt>
<dd><p>Value that are the intercept</p>
</dd></dl>

<p>Below is an example of using MKSHomogenizationModel to predict (or
classify) the type of microstructure using PCA and Logistic Regression.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_states</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">domain</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">LegendreBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">leg_basis</span> <span class="o">=</span> <span class="n">LegendreBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="n">n_states</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">domain</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reducer</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linker</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSHomogenizationModel</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">basis</span><span class="o">=</span><span class="n">leg_basis</span><span class="p">,</span> <span class="n">dimension_reducer</span><span class="o">=</span><span class="n">reducer</span><span class="p">,</span> <span class="n">property_linker</span><span class="o">=</span><span class="n">linker</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.datasets</span> <span class="kn">import</span> <span class="n">make_cahn_hilliard</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X0</span><span class="p">,</span> <span class="n">X1</span> <span class="o">=</span> <span class="n">make_cahn_hilliard</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X0</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">X0</span><span class="p">,</span> <span class="n">X1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X0_test</span><span class="p">,</span> <span class="n">X1_test</span> <span class="o">=</span> <span class="n">make_cahn_hilliard</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y0_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X0_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1_test</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X1_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y0_test</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y1_test</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>Create an instance of a <cite>MKSHomogenizationModel</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>basis</strong> (<em>class, optional</em>) &#8211; an instance of a bases class.</li>
<li><strong>dimension_reducer</strong> (<em>class, optional</em>) &#8211; an instance of a
dimensionality reduction class with a fit_transform method. The
default class is RandomizedPCA.</li>
<li><strong>property_linker</strong> (<em>class, optional</em>) &#8211; an instance for a machine
learning class with fit and predict methods.</li>
<li><strong>n_components</strong> (<em>int, optional</em>) &#8211; number of components kept by the
dimension_reducer</li>
<li><strong>degree</strong> (<em>int, optional</em>) &#8211; degree of the polynomial used by
property_linker.</li>
<li><strong>periodic_axes</strong> (<em>list, optional</em>) &#8211; axes that are periodic. (0, 2)
would indicate that axes x and z are periodic in a 3D
microstrucure.</li>
<li><strong>correlations</strong> (<em>list, optional</em>) &#8211; list of spatial correlations to
compute, default is the autocorrelation with the first local
state and all of its cross correlations. For example if basis
has basis.n_states=3, correlation would be [(0, 0), (0, 1),
(0, 2)]. If n_states=[0, 2, 4], the default correlations are
[(0, 0), (0, 2), (0, 4)] corresponding to the autocorrelations
for the 0th local state, and the cross correlations with the 0
and 2 as well as 0 and 4.</li>
<li><strong>compute_correlations</strong> (<em>boolean, optional</em>) &#8211; If false spatial
correlations will not be calculated as part of the fit and
predict methods. The spatial correlations can be passed as <cite>X</cite>
to both methods, default is True.</li>
<li><strong>n_jobs</strong> (<em>int, optional</em>) &#8211; number of parallel jobs to run. only used
if pyfftw is install.</li>
<li><strong>store_correlations</strong> (<em>boolean, optional</em>) &#8211; indicate if spatial
correlations should be stored</li>
<li><strong>mean_center</strong> (<em>boolean, optional</em>) &#8211; If true the data will be mean
centered before dimensionality reduction is computed.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pymks.mks_homogenization_model.MKSHomogenizationModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>reduce_labels=None</em>, <em>confidence_index=None</em>, <em>size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_homogenization_model.MKSHomogenizationModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits data by calculating 2-point statistics from X, preforming
dimension reduction using dimension_reducer, and fitting the reduced
data with the property_linker.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>ND array</em>) &#8211; The microstructures or spatial correlations, a
<cite>(n_samples, n_x, ...)</cite> shaped array where <cite>n_samples</cite> is the
number of samples and <cite>n_x</cite> is the spatial discretization.</li>
<li><strong>y</strong> (<em>1D array</em>) &#8211; The material property associated with <cite>X</cite>.</li>
<li><strong>reducer_labels</strong> (<em>1D array, optional</em>) &#8211; label for X used during the
fit_transform method for the <cite>dimension_reducer</cite>.</li>
<li><strong>confidence_index</strong> (<em>ND array, optional</em>) &#8211; array with same shape as X
used to assign a confidence value for each data point.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example</p>
<p>Let&#8217;s first start with using the microstructure and effective
properties.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.stats</span> <span class="kn">import</span> <span class="n">correlate</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reducer</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linker</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">correlations</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSHomogenizationModel</span><span class="p">(</span><span class="n">prim_basis</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">dimension_reducer</span><span class="o">=</span><span class="n">reducer</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">property_linker</span><span class="o">=</span><span class="n">linker</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">correlations</span><span class="o">=</span><span class="n">correlations</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_stats</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">prim_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_reshaped</span> <span class="o">=</span> <span class="n">X_stats</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_stats</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_pca</span> <span class="o">=</span> <span class="n">reducer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_reshaped</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X_reshaped</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">reduced_fit_data</span><span class="p">,</span> <span class="n">X_pca</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let&#8217;s use the same method with spatial correlations instead of
microtructures.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.stats</span> <span class="kn">import</span> <span class="n">correlate</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">reducer</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linker</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">correlations</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSHomogenizationModel</span><span class="p">(</span><span class="n">dimension_reducer</span><span class="o">=</span><span class="n">reducer</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">property_linker</span><span class="o">=</span><span class="n">linker</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">compute_correlations</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_stats</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">prim_basis</span><span class="p">,</span> <span class="n">correlations</span><span class="o">=</span><span class="n">correlations</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_stats</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_reshaped</span> <span class="o">=</span> <span class="n">X_stats</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X_stats</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X_stats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_pca</span> <span class="o">=</span> <span class="n">reducer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_reshaped</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X_reshaped</span><span class="p">,</span>
<span class="gp">... </span>                              <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="bp">None</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">reduced_fit_data</span><span class="p">,</span> <span class="n">X_pca</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymks.mks_homogenization_model.MKSHomogenizationModel.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X</em>, <em>confidence_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_homogenization_model.MKSHomogenizationModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts macroscopic property for the microstructures <cite>X</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>ND array</em>) &#8211; The microstructure, an <cite>(n_samples, n_x, ...)</cite>
shaped array where <cite>n_samples</cite> is the number of samples and
<cite>n_x</cite> is the spatial discretization.</li>
<li><strong>confidence_index</strong> (<em>ND array, optional</em>) &#8211; array with same shape as X
used to assign a confidence value for each data point.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The predicted macroscopic property for <cite>X</cite>.</p>
</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">LocallyLinearEmbedding</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">BayesianRidge</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reducer</span> <span class="o">=</span> <span class="n">LocallyLinearEmbedding</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">linker</span> <span class="o">=</span> <span class="n">BayesianRidge</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSHomogenizationModel</span><span class="p">(</span><span class="n">prim_basis</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">dimension_reducer</span><span class="o">=</span><span class="n">reducer</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">property_linker</span><span class="o">=</span><span class="n">linker</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>Predict with microstructures</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
<p>Predict with spatial correlations</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.stats</span> <span class="kn">import</span> <span class="n">correlate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">compute_correlations</span> <span class="o">=</span> <span class="bp">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_corr</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">prim_basis</span><span class="p">,</span> <span class="n">correlations</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_corr</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_corr_test</span> <span class="o">=</span> <span class="n">correlate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">prim_basis</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">correlations</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_pred_stats</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_corr_test</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y_pred_stats</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymks.mks_homogenization_model.MKSHomogenizationModel.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>confidence_index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_homogenization_model.MKSHomogenizationModel.score" title="Permalink to this definition">¶</a></dt>
<dd><p>The score function for the MKSHomogenizationModel. It formats the
data and uses the score method from the property_linker.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>ND array</em>) &#8211; The microstructure, an <cite>(n_samples, n_x, ...)</cite>
shaped array where <cite>n_samples</cite> is the number of samples and
<cite>n_x</cite> is the spatial discretization.</li>
<li><strong>y</strong> (<em>1D array</em>) &#8211; The material property associated with <cite>X</cite>.</li>
<li><strong>confidence_index</strong> (<em>ND array, optional</em>) &#8211; array with same shape as X
used to assign a confidence value for each data point.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Score for MKSHomogenizationModel from the selected
property_linker.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mkslocalizationmodel">
<h2>MKSLocalizationModel<a class="headerlink" href="#mkslocalizationmodel" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pymks.mks_localization_model.MKSLocalizationModel">
<em class="property">class </em><code class="descclassname">pymks.mks_localization_model.</code><code class="descname">MKSLocalizationModel</code><span class="sig-paren">(</span><em>basis</em>, <em>n_states=None</em>, <em>n_jobs=1</em>, <em>lstsq_rcond=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_localization_model.MKSLocalizationModel" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>MKSLocalizationModel</cite> fits data using the Materials Knowledge
System in Fourier Space. The following demonstrates the viability
of the <cite>MKSLocalizationModel</cite> with a simple 1D filter.</p>
<dl class="attribute">
<dt id="MKSLocalizationModel.basis">
<code class="descname">basis</code><a class="headerlink" href="#MKSLocalizationModel.basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Basis function used to discretize the microstucture.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSLocalizationModel.n_states">
<code class="descname">n_states</code><a class="headerlink" href="#MKSLocalizationModel.n_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Interger value for number of local states, if a basis
is specified, n_states indicates the order of the polynomial.</p>
</dd></dl>

<dl class="attribute">
<dt id="MKSLocalizationModel.coef_">
<code class="descname">coef_</code><a class="headerlink" href="#MKSLocalizationModel.coef_" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of values that are the influence coefficients.</p>
</dd></dl>

<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n_states</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_spaces</span> <span class="o">=</span> <span class="mi">81</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">400</span>
</pre></div>
</div>
<p>Define a filter function.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">),</span>
<span class="gp">... </span>                    <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">20</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
</pre></div>
</div>
<p>Use the filter function to construct some coefficients.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coef_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n_states</span><span class="p">)[</span><span class="bp">None</span><span class="p">,:]</span> <span class="o">*</span> <span class="nb">filter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>                                                     <span class="n">n_spaces</span><span class="p">))[:,</span><span class="bp">None</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Fcoef_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">coef_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Make some test samples.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_spaces</span><span class="p">))</span>
</pre></div>
</div>
<p>Construct a response with the <cite>Fcoef_</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_states</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">X</span><span class="p">[:,:,</span><span class="bp">None</span><span class="p">]</span> <span class="o">-</span> <span class="n">H</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">H</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">H</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">X_</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Fy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Fcoef_</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">FX</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Fy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
</pre></div>
</div>
<p>Use the <cite>MKSLocalizationModel</cite> to reconstruct the coefficients</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSLocalizationModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">prim_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Check the result</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">coef_</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,)),</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
<p>Instantiate a MKSLocalizationModel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>basis</strong> (<em>class</em>) &#8211; an instance of a bases class.</li>
<li><strong>n_states</strong> (<em>int, optional</em>) &#8211; number of local states</li>
<li><strong>n_jobs</strong> (<em>int, optional</em>) &#8211; number of parallel jobs to run. only used
if pyfftw is install.</li>
<li><strong>lstsq_rcond</strong> (<em>float, optional</em>) &#8211; rcond argument to scipy.linalg.lstsq
function. Defaults to 4 orders of magnitude above machine
epsilon.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pymks.mks_localization_model.MKSLocalizationModel.coef_">
<code class="descname">coef_</code><a class="headerlink" href="#pymks.mks_localization_model.MKSLocalizationModel.coef_" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coefficients in real space with origin shifted to the
center.</p>
</dd></dl>

<dl class="method">
<dt id="pymks.mks_localization_model.MKSLocalizationModel.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_localization_model.MKSLocalizationModel.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the data by calculating a set of influence coefficients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>ND array</em>) &#8211; The microstructure, an <cite>(n_samples, n_x, ...)</cite>
shaped array where <cite>n_samples</cite> is the number of samples and
<cite>n_x</cite> is the spatial discretization.</li>
<li><strong>y</strong> (<em>ND array</em>) &#8211; The response field, same shape as <cite>X</cite>.</li>
<li><strong>size</strong> (<em>tuple, optional</em>) &#8211; Alters the shape of X and y during the
calibration of the influence coefficients. If None, the size
of the influence coefficients is the same shape as <cite>X</cite> and <cite>y</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSLocalizationModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">prim_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">_filter</span><span class="o">.</span><span class="n">_Fkernel</span><span class="p">,</span> <span class="p">[[[</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>                                             <span class="p">[</span>  <span class="o">-</span><span class="mi">2</span><span class="p">,</span>    <span class="mi">0</span><span class="p">]],</span>
<span class="gp">... </span>                                            <span class="p">[[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mi">0</span>  <span class="p">],</span>
<span class="gp">... </span>                                             <span class="p">[</span>  <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span>  <span class="p">]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymks.mks_localization_model.MKSLocalizationModel.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_localization_model.MKSLocalizationModel.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts a new response from the microstructure function <cite>X</cite> with
calibrated influence coefficients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> (<em>ND array</em>) &#8211; The microstructure, an <cite>(n_samples, n_x, ...)</cite>
shaped array where <cite>n_samples</cite> is the number of samples and
<cite>n_x</cite> is the spatial discretization.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The predicted response field the same shape as <cite>X</cite>.</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSLocalizationModel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="n">prim_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</pre></div>
</div>
<p>The fit method must be called to calibrate the coefficients before
the predict method can be used.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MKSModel</span> <span class="o">=</span> <span class="n">MKSLocalizationModel</span><span class="p">(</span><span class="n">prim_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MKSModel</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">fit() method must be run before predict().</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="pymks.mks_localization_model.MKSLocalizationModel.resize_coeff">
<code class="descname">resize_coeff</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#pymks.mks_localization_model.MKSLocalizationModel.resize_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the size of the coefficients and pad with zeros.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong> (<em>tuple</em>) &#8211; The new size of the influence coefficients.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The resized influence coefficients to size.</td>
</tr>
</tbody>
</table>
<p>Example</p>
<p>Let&#8217;s first instantitate a model and fabricate some
coefficients.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pymks.bases</span> <span class="kn">import</span> <span class="n">PrimitiveBasis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span> <span class="o">=</span> <span class="n">PrimitiveBasis</span><span class="p">(</span><span class="n">n_states</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prim_basis</span><span class="o">.</span><span class="n">_axes_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">MKSLocalizationModel</span><span class="p">(</span><span class="n">prim_basis</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coef_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coef_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">coef_</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">coef_</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coef_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifftshift</span><span class="p">(</span><span class="n">coef_</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">_filter</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftn</span><span class="p">(</span><span class="n">coef_</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
<span class="gp">... </span>                       <span class="n">prim_basis</span><span class="p">)</span>
</pre></div>
</div>
<p>The coefficients can be reshaped by passing the new shape that
coefficients should have.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">resize_coeff</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="o">...</span> <span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                   <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>